CREATE OR REPLACE PROCEDURE DFWECONOMYPASSENGERS IS
  CURSOR ECOPASSDETAILS IS
    SELECT al.AL_NAME, fl.FLIGHT_CODE, p2.FNAME, p2.LNAME, p2.PASSPORTNO, 
           t.CLASS, t.DATE_OF_TRAVEL, t.DESTINATION, t.SOURCE, t.SEATNO, t.TICKET_NUMBER
    FROM Airline al
    JOIN Flight fl ON al.AIRLINEID = fl.AIRLINEID
    JOIN PASSENGER3 p3 ON fl.FLIGHT_CODE = p3.FLIGHT_CODE
    JOIN PASSENGER1 p1 ON p1.PID = p3.PID
    JOIN PASSENGER2 p2 ON p2.PASSPORTNO = p1.PASSPORTNO
    JOIN TICKET1 t ON t.PASSPORTNO = p2.PASSPORTNO
    WHERE t.CLASS = 'ECONOMY' AND t.DESTINATION = 'DFW';
  
  PASSDETAILS ECOPASSDETAILS%ROWTYPE;

BEGIN
  OPEN ECOPASSDETAILS;
  LOOP
    FETCH ECOPASSDETAILS INTO PASSDETAILS;
    EXIT WHEN ECOPASSDETAILS%NOTFOUND;
    DBMS_OUTPUT.PUT_LINE(PASSDETAILS.AL_NAME || '  ' || PASSDETAILS.FLIGHT_CODE || '  ' ||
                         PASSDETAILS.FNAME || '  ' || PASSDETAILS.LNAME || '  ' ||
                         PASSDETAILS.PASSPORTNO || '  ' || PASSDETAILS.CLASS || '  ' ||
                         PASSDETAILS.SOURCE || '  ' || PASSDETAILS.SEATNO || '  ' || 
                         PASSDETAILS.TICKET_NUMBER);
  END LOOP;
  CLOSE ECOPASSDETAILS;
END DFWECONOMYPASSENGERS;

-- Executing the procedure:
BEGIN
  DFWECONOMYPASSENGERS();
END;
